<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />


<meta name="date" content="2021-09-07" />

<title>Extract data from a yspec object</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>
<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Extract data from a yspec object</h1>
<h4 class="author"></h4>
<h4 class="date">2021-09-07</h4>


<div id="TOC">
<ul>
<li><a href="#introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="#set-up"><span class="toc-section-number">2</span> Set up</a></li>
<li><a href="#basic"><span class="toc-section-number">3</span> Basic</a></li>
<li><a href="#get-units"><span class="toc-section-number">4</span> Get units</a></li>
<li><a href="#get-labels"><span class="toc-section-number">5</span> Get labels</a></li>
<li><a href="#get-short"><span class="toc-section-number">6</span> Get short</a></li>
<li><a href="#get-short-with-unit"><span class="toc-section-number">7</span> Get short with unit</a></li>
<li><a href="#meta-information"><span class="toc-section-number">8</span> Meta information</a>
<ul>
<li><a href="#what-is-in-the-meta-data"><span class="toc-section-number">8.1</span> What is in the meta data?</a></li>
</ul></li>
</ul>
</div>

<div id="introduction" class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>This vignette shows you how to extract information from a yspec object.</p>
</div>
<div id="set-up" class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> Set up</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">comment =</span> <span class="st">&#39;.&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">library</span>(purrr)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="kw">library</span>(yspec)</span></code></pre></div>
</div>
<div id="basic" class="section level1" number="3">
<h1 number="3"><span class="header-section-number">3</span> Basic</h1>
<p>First, recall that the yspec object is just a list. We can use map to get information out of that list. For example, to find the types of all the columns in the data set use <code>purrr:::map</code></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>spec &lt;-<span class="st"> </span>ys_help<span class="op">$</span><span class="kw">spec</span>()</span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="kw">map</span>(spec, <span class="st">&quot;type&quot;</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</span></code></pre></div>
<pre><code>. $C
. [1] &quot;character&quot;
. 
. $NUM
. [1] &quot;numeric&quot;
. 
. $ID
. [1] &quot;numeric&quot;
. 
. $SUBJ
. [1] &quot;character&quot;
. 
. $TIME
. [1] &quot;numeric&quot;</code></pre>
<p>If we wanted some column information in csv format we could also do</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">map</span>(spec, <span class="op">~</span><span class="st"> </span><span class="kw">paste</span>(.x[[<span class="st">&quot;col&quot;</span>]],.x[[<span class="st">&quot;short&quot;</span>]],.x[[<span class="st">&quot;type&quot;</span>]],<span class="dt">sep=</span><span class="st">&#39;,&#39;</span>))[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</span></code></pre></div>
<pre><code>. $C
. [1] &quot;C,comment character,character&quot;
. 
. $NUM
. [1] &quot;NUM,record number,numeric&quot;
. 
. $ID
. [1] &quot;ID,subject identifier,numeric&quot;</code></pre>
<p>There are other helper functions that do more than just pull a field. We can extract a label and form a unit.</p>
</div>
<div id="get-units" class="section level1" number="4">
<h1 number="4"><span class="header-section-number">4</span> Get units</h1>
<p>Call <code>ys_get_unit</code> to get a named list of units. When the <code>parens</code> argument is true, it will put parentheses around the unit. Notice that the output here is different than if we were to only map across the list and ask for the unit field. Many columns don’t have units and we’d get <code>NULL</code> back if we just mapped. The <code>ys_get_unit</code> function subs in blank character data items when <code>unit</code> is <code>NULL</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">ys_get_unit</span>(spec, <span class="dt">parens =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unlist</span>()</span></code></pre></div>
<pre><code>.                C              NUM               ID             SUBJ 
.               &quot;&quot;               &quot;&quot;               &quot;&quot;               &quot;&quot; 
.             TIME              SEQ              CMT             EVID 
.         &quot;(hour)&quot;               &quot;&quot;               &quot;&quot;               &quot;&quot; 
.              AMT               DV              AGE               WT 
.           &quot;(mg)&quot; &quot;(micrograms/L)&quot;        &quot;(years)&quot;           &quot;(kg)&quot; 
.             CRCL              ALB              BMI              AAG 
.       &quot;(ml/min)&quot;         &quot;(g/dL)&quot;        &quot;(m2/kg)&quot;        &quot;(mg/dL)&quot; 
.              SCR              AST              ALT               HT 
.        &quot;(mg/dL)&quot;               &quot;&quot;               &quot;&quot;           &quot;(cm)&quot; 
.               CP             TAFD              TAD             LDOS 
.               &quot;&quot;        &quot;(hours)&quot;        &quot;(hours)&quot;           &quot;(mg)&quot; 
.              MDV              BLQ            PHASE            STUDY 
.               &quot;&quot;               &quot;&quot;               &quot;&quot;               &quot;&quot; 
.               RF 
.               &quot;&quot;</code></pre>
</div>
<div id="get-labels" class="section level1" number="5">
<h1 number="5"><span class="header-section-number">5</span> Get labels</h1>
<p>We can also get labels</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">ys_get_label</span>(spec)[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</span></code></pre></div>
<pre><code>. $C
. [1] &quot;comment character&quot;
. 
. $NUM
. [1] &quot;record number&quot;
. 
. $ID
. [1] &quot;subject identifier&quot;</code></pre>
</div>
<div id="get-short" class="section level1" number="6">
<h1 number="6"><span class="header-section-number">6</span> Get short</h1>
<p>We can also get the short name</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">ys_get_short</span>(spec)[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</span></code></pre></div>
<pre><code>. $C
. [1] &quot;comment character&quot;
. 
. $NUM
. [1] &quot;record number&quot;
. 
. $ID
. [1] &quot;subject identifier&quot;</code></pre>
</div>
<div id="get-short-with-unit" class="section level1" number="7">
<h1 number="7"><span class="header-section-number">7</span> Get short with unit</h1>
<p>This function returns a string with both the <code>unit</code> and <code>short</code></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">ys_get_short_unit</span>(spec, <span class="dt">parens =</span> <span class="ot">TRUE</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>] <span class="op">%&gt;%</span><span class="st"> </span>as.list</span></code></pre></div>
<pre><code>. $C
. [1] &quot;comment character&quot;
. 
. $NUM
. [1] &quot;record number&quot;
. 
. $ID
. [1] &quot;subject identifier&quot;
. 
. $SUBJ
. [1] &quot;subject identifier&quot;
. 
. $TIME
. [1] &quot;TIME (hour)&quot;</code></pre>
</div>
<div id="meta-information" class="section level1" number="8">
<h1 number="8"><span class="header-section-number">8</span> Meta information</h1>
<p>The information you entered in <code>SETUP__</code> as well as other meta information is stored as a list in the <code>meta</code> attribute of the <code>yspec</code> list. It can be accessed with <code>get_meta</code>. This returns a list with the various pieces of meta data.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">get_meta</span>(spec)[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</span></code></pre></div>
<pre><code>. $description
. [1] &quot;Example PopPK analysis data set&quot;
. 
. $sponsor
. [1] &quot;example-project&quot;
. 
. $projectnumber
. [1] &quot;EXAMPK1011F&quot;</code></pre>
<p>You an pull a single piece of meta data with</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">pull_meta</span>(spec, <span class="st">&quot;projectnumber&quot;</span>)</span></code></pre></div>
<pre><code>. [1] &quot;EXAMPK1011F&quot;</code></pre>
<div id="what-is-in-the-meta-data" class="section level2" number="8.1">
<h2 number="8.1"><span class="header-section-number">8.1</span> What is in the meta data?</h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>m &lt;-<span class="st"> </span><span class="kw">get_meta</span>(spec)</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">names</span>(m)</span></code></pre></div>
<pre><code>.  [1] &quot;description&quot;     &quot;sponsor&quot;         &quot;projectnumber&quot;   &quot;use_internal_db&quot;
.  [5] &quot;glue&quot;            &quot;flags&quot;           &quot;lookup_file&quot;     &quot;spec_file&quot;      
.  [9] &quot;spec_path&quot;       &quot;name&quot;            &quot;data_stem&quot;       &quot;data_path&quot;      
. [13] &quot;primary_key&quot;     &quot;control&quot;         &quot;namespace&quot;</code></pre>
<p>Some descriptions:</p>
<ol style="list-style-type: decimal">
<li><code>spec_file</code>: the yaml source file for the specification information</li>
<li><code>spec_path</code>: the directory where the yaml source file is located</li>
<li><code>name</code>: the stem of the yaml source file</li>
<li><code>data_stem</code>: the stem that is used and it is assumed that data sets will be written using this stem (for example <code>&lt;data_stem&gt;.csv</code> etc).</li>
<li><code>data_path</code>: the assumed derived data directory</li>
</ol>
<p>See also <a href="reference.html">reference.html</a> for descriptions of meta fields.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
